<ion-header>
  <app-header [showBackButton]="false" title="Mis planes"></app-header>
</ion-header>

<ion-content>
  @if (isLoadingPlans) {
    <div class="custom-skeleton">
      <ion-list>
        @for (item of fakePlans; track item) {
          <ion-item>
            <ion-item>
              <ion-label>
                <h2>
                  <ion-skeleton-text
                    animated
                    style="width: 40%"
                  ></ion-skeleton-text>
                </h2>
                <h3>
                  <ion-skeleton-text
                    animated
                    style="width: 60%"
                  ></ion-skeleton-text>
                </h3>
              </ion-label>
            </ion-item>
          </ion-item>
        }
      </ion-list>
    </div>
  } @else {
    @if (plans.length === 0) {
      <app-empty-message></app-empty-message>
    }
    @if (plans.length > 0) {
      <ion-list>
        @for (plan of plans; track plan) {
          <ion-item-sliding>
            @if (plan.status === PlanStatus.Draft) {
              <ion-item-options side="start">
                <ion-item-option color="success" (click)="onStartClick(plan)"
                  ><ion-icon name="play" slot="start"></ion-icon>
                  Iniciar</ion-item-option
                  >
                </ion-item-options>
              }
              <ion-item>
                <ion-label>
                  <h2>{{ plan.goal }}</h2>
                  <h3>{{ plan.amount_to_save | currency: "COP" }}</h3>
                </ion-label>
              </ion-item>
              @if (plan.status < PlanStatus.Completed) {
                <ion-item-options side="end">
                  @if (plan.status === PlanStatus.Draft) {
                    <ion-item-option
                      (click)="onUpdateClick(plan)"
                      ><ion-icon name="pencil" slot="start"></ion-icon>
                      Editar</ion-item-option
                      >
                    }
                    @if (plan.status === PlanStatus.Draft) {
                      <ion-item-option
                        color="danger"
                        (click)="onDeleteClick(plan)"
                        ><ion-icon name="trash" slot="start"></ion-icon>
                        Eliminar</ion-item-option
                        >
                      }
                      @if (plan.status === PlanStatus.Started) {
                        <ion-item-option
                          color="warning"
                          (click)="onDiscardClick(plan)"
                          ><ion-icon name="close" slot="start"></ion-icon>
                          Descartar</ion-item-option
                          >
                        }
                      </ion-item-options>
                    }
                  </ion-item-sliding>
                }
              </ion-list>
            }
            <ion-fab vertical="bottom" horizontal="end" slot="fixed">
              <ion-fab-button color="tertiary" (click)="onCreateClick()">
                <ion-icon name="add"></ion-icon>
              </ion-fab-button>
            </ion-fab>
          }

        </ion-content>
